> ê¹€ì˜í•œë‹˜ì˜ ìŠ¤í”„ë§ í•µì‹¬ì›ë¦¬ -ê¸°ë³¸í¸ì„ ë³´ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤!!

# ë¹ˆ ìŠ¤ì½”í”„

## ë¹ˆ ìŠ¤ì½”í”„ë€?
ìŠ¤ì½”í”„ëŠ” ì‚¬ì „ì  ì˜ë¯¸ë¡œ ë²”ìœ„ë¼ëŠ” ëœ», ì¦‰ ë¹ˆì˜ ì¡´ì¬ í• ìˆ˜ ìˆëŠ” ë²”ìœ„ë‹¤.
ìš°ë¦¬ê°€ ì¼ë°˜ì ìœ¼ë¡œ ìŠ¤í”„ë§ ë¹ˆì„ ìƒì„±í•  ë•Œ ì‹±ê¸€í†¤ ìŠ¤ì½”í”„ë¡œ ìƒì„±í•˜ëŠ”ë° 
ì‹±ê¸€í†¤ ìŠ¤ì½”í”„ëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰í•˜ê³  ì¢…ë£Œë ë•Œ ê¹Œì§€ ë¹ˆì´ ìœ ì§€ëœë‹¤.

### ë¹ˆì˜ ìŠ¤ì½”í”„

- ì‹±ê¸€í†¤

    ê¸°ë³¸ ìŠ¤ì½”í”„, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì˜ ì‹œì‘ë¶€í„° ì¢…ë£Œê¹Œì§€ ìœ ì§€ë˜ëŠ” ìŠ¤ì½”í”„

- í”„ë¡œí† íƒ€ì…

    ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì…ë¹ˆì˜ ìƒì„±ê³¼ ì˜ì¡´ê´€ê³„ ì£¼ì…, ì´ˆê¸°í™”ê¹Œì§€ë§Œ ê´€ì—¬í•˜ëŠ” ìŠ¤ì½”í”„

- ì›¹ ê´€ë ¨ ìŠ¤ì½”í”„
    - request
        
        > HTTP ìš”ì²­ í•˜ë‚˜ê°€ ë“¤ì–´ì˜¤ê³  ë‚˜ê°ˆ ë•Œ ê¹Œì§€ ìœ ì§€ë˜ëŠ” ìŠ¤ì½”í”„, `ê°ê°ì˜ HTTP ìš”ì²­`ë§ˆë‹¤ `ë³„ë„ì˜ ë¹ˆ ì¸ìŠ¤í„´ìŠ¤`ê°€ ìƒì„±ë˜ê³ , ê´€ë¦¬

    - session

        > HTTP Sessionê³¼ ë™ì¼í•œ ìƒëª…ì£¼ê¸°ë¥¼ ê°€ì§€ëŠ” ìŠ¤ì½”í”„

    - application

        > ì„œë¸”ë¦¿ ì»¨í…ìŠ¤íŠ¸( ServletContext )ì™€ ë™ì¼í•œ ìƒëª…ì£¼ê¸°ë¥¼ ê°€ì§€ëŠ” ìŠ¤ì½”í”„

    - websocket

        > ì›¹ ì†Œì¼“ê³¼ ë™ì¼í•œ ìƒëª…ì£¼ê¸°ë¥¼ ê°€ì§€ëŠ” ìŠ¤ì½”í”„


## ì‹±ê¸€í†¤ ìŠ¤ì½”í”„

__ì‹±ê¸€í†¤ ë¹ˆ ìš”ì²­__

![image](https://user-images.githubusercontent.com/97019540/230186748-d8deee0b-f6ee-4332-ad26-6c4e51640b47.png)

<details>

<summary>
__SingletonBeanTest.class__
</summary>

```java
@Test
void singletonBeanFind(){
    AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(SingletonBean.class);
    SingletonBean sb1 = ac.getBean(SingletonBean.class);
    SingletonBean sb2 = ac.getBean(SingletonBean.class);
    System.out.println("SingletonBean1 = " + sb1);
    System.out.println("SingletonBean2 = " + sb2);
    Assertions.assertThat(sb1).isSameAs(sb2);
    ac.close();
}

@Scope("singleton")
static class SingletonBean{
    @PostConstruct
    public void init(){
        System.out.println("SingletonBean.init");
    }
    @PreDestroy
    public void destroy(){
        System.out.println("SingletonBean.destroy");
    }
}
```
</details>

<details>
<summary> 
Test Result
</summary>

![image](https://user-images.githubusercontent.com/97019540/231126829-6ddf9f97-3eec-4e85-8ca0-91936d2d36fd.png)

</details>

__ì‹±ê¸€í†¤ ë¹ˆ ìŠ¤ì½”í”„ íŠ¹ì§•__
- ê°€ì¥ ë„“ì€ ë²”ìœ„ì˜ ë¹ˆ ìŠ¤ì½”í”„
- í•˜ë‚˜ì˜ ê°ì²´ê°€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±ë˜ê³  ê´€ë¦¬ë¨
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ì¢…ë£Œì‹œ ì†Œë©¸ì „ ì½œë°± ë©”ì„œë“œê¹Œì§€ í˜¸ì¶œë¨

## í”„ëŸ¬í† íƒ€ì… ìŠ¤ì½”í”„

__í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ ë¹ˆ ìš”ì²­__

![image](https://user-images.githubusercontent.com/97019540/231084556-04458816-4e70-4e2b-ab9a-4fba32922470.png)

<details>

<summary>
__ProtoTypeBeanTest.class__
</summary>

```java
@Test
void PrototypeBeanFind(){
    AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(PrototypeBean.class);
    System.out.println("get prototypeBean1");
    PrototypeBean pb1 = ac.getBean(PrototypeBean.class);
    System.out.println("get prototypeBean2");
    PrototypeBean pb2 = ac.getBean(PrototypeBean.class);
    System.out.println("PrototypeBean1 = " + pb1);
    System.out.println("PrototypeBean2 = " + pb2);
    // Assertions.assertThat(pb1).isSameAs(pb2); ë‹¤ë¥¸ ê°ì²´ë¥¼ ë°˜í™˜ ì‹±ê¸€í†¤ X
    Assertions.assertThat(pb1).isNotSameAs(pb2);
    ac.close();
}

@Scope("prototype")
static class PrototypeBean{
    @PostConstruct
    public void init(){
        System.out.println("PrototypeBean.init");
    }
    @PreDestroy
    public void destroy(){
        //í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ ë¹ˆì€ destoryë¥¼ í˜¸ì¶œí•˜ì§€ ì•ŠëŠ”ë‹¤. ìƒì„±í•˜ê³  ì˜ì¡´ê´€ê³„ì£¼ì…ê¹Œì§€ë§Œ ê´€ë¦¬í•˜ê¸°ë•Œë¬¸
        System.out.println("PrototypeBean.destroy");
    }
}
```
</details>

<details>

<summary>
__Test Result__
</summary>

![image](https://user-images.githubusercontent.com/97019540/231127033-a4dac491-443a-4e99-927b-eaf12d8f8ea9.png)



</details>

__í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ íŠ¹ì§•__
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— `ìš”ì²­í•  ë•Œ` ë§ˆë‹¤ ìƒˆë¡œ ìƒì„±
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆì˜ `ìƒì„±`ê³¼ `ì˜ì¡´ê´€ê³„ ì£¼ì…` ê·¸ë¦¬ê³  `ì´ˆê¸°í™”`ê¹Œì§€ë§Œ ê´€ì—¬
- ì¢…ë£Œ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤.
- í”„ë¡œí† íƒ€ì… ë¹ˆì€ `í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì¡°íšŒí•œ í´ë¼ì´ì–¸íŠ¸ê°€ ê´€ë¦¬`í•´ì•¼í•¨
- `ì¢…ë£Œ ë©”ì„œë“œì— ëŒ€í•œ í˜¸ì¶œ`ë„ `í´ë¼ì´ì–¸íŠ¸ê°€ ì§ì ‘` í•´ì•¼í•¨

__í”„ë¡œí† íƒ€ì… ë¹ˆì€ ì–¸ì œ ì‚¬ìš©í•˜ë‚˜?__
> ë§¤ë²ˆ ì‚¬ìš©í• ë•Œ ë§ˆë‹¤ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ìƒì„±í•´ì•¼ í• ë•Œ
    
> But, ì‹¤ë¬´ì—ì„œëŠ” ì‹±ê¸€í†¤ìœ¼ë¡œ ëŒ€ë¶€ë¶„ í•´ê²° ê°€ëŠ¥í•˜ë¯€ë¡œ ì‚¬ìš©í•  ì¼ì´ ë“œë¬¼ë‹¤.

## í”„ë¡œí† íƒ€ì… ë¹ˆê³¼ ì‹±ê¸€í†¤ ë¹ˆ ê°™ì´ ì‚¬ìš©ì‹œ ë¬¸ì œì 

![image](https://user-images.githubusercontent.com/97019540/231427518-184bebf0-d6d1-42f2-b074-709a2aa6ca0a.png)

__ClientBean.class__
```java
@Scope("singleton") //defualtê°€ ì‹±ê¸€í†¤ ìƒëµê°€ëŠ¥
static class ClientBean{

    private PrototypeBean prototypeBean ; // ClientBeanì˜ ìƒì„±ì‹œì ì— ê°™ì´ ì£¼ì…ëœë‹¤.

    @Autowired
    public ClientBean(PrototypeBean prototypeBean){
        this.prototypeBean = prototypeBean;
    }

    public int logic(){
        //count ì¦ê°€í›„ ì¦ê°€ëœ count ê°’ ë¦¬í„´
        prototypeBean.addCount();
        System.out.println(prototypeBean.toString());
        return prototypeBean.getCount();
    }

    @PostConstruct
    public void init(){
        System.out.println("ClientBean.init "+ this);
    }

    @PreDestroy
    public void destroy(){
        System.out.println("ClientBean.destroy "+ this);
    }
}
```

__PrototypeBean.class__
```java
@Scope("prototype")
static class PrototypeBean{

    private int count=0;
    /*í™•ì¸ìš© ì½”ë“œ
    public PrototypeBean(){
        addCount();
    }*/
    public void addCount(){
        count++;
    }

    public int getCount(){
        return count;
    }

    @PostConstruct
    public void init(){
        System.out.println("ProtoTypeBean.init "+ this);
    }

    @PreDestroy
    public void destroy(){
        System.out.println("ProtoTypeBean.destroy "+ this);
    }
}
```

__ì‹±ê¸€í†¤ ì•ˆì— í”„ë¡œí† íƒ€ì… ì‚¬ìš©ì‹œ í…ŒìŠ¤íŠ¸__

```java
@Test
void singletonClientusePrototype(){
    AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(ClientBean.class , PrototypeBean.class);
    int count = 0; //count init;


    ClientBean clientBean1 = ac.getBean(ClientBean.class);
    count = clientBean1.logic();
    System.out.println("clientBean1.logic() // count => "+ count);

    ClientBean clientBean2 = ac.getBean(ClientBean.class);
    count = clientBean2.logic();
    System.out.println("clientBean2.logic() // count => "+ count);

    ClientBean clientBean3 = ac.getBean(ClientBean.class);
    count = clientBean3.logic();
    System.out.println("clientBean3.logic() // count => "+ count);

    Assertions.assertThat(count).isEqualTo(3);
    ac.close();
}
```

__í…ŒìŠ¤íŠ¸ ê²°ê³¼__

![image](https://user-images.githubusercontent.com/97019540/231430856-146e84bb-09dc-4a9a-be51-f012acee8238.png)

__ë¬¸ì œì __
- ClientBean ìƒì„±ì‹œì— PrototypeBeanì´ í•„ìš”í•˜ë¯€ë¡œ ê°™ì´ ì£¼ì…
- ClientBean.logic() í˜¸ì¶œ ì‹œ ë‚´ë¶€í•„ë“œì— prototypeBeanì„ ì‚¬ìš©í•¨
- ì¦‰ , ì´ë¯¸ ClientBean ìƒì„±ì‹œì— ì£¼ì…ë°›ì€ prototypeBeanì„ ê³„ì† ì‚¬ìš©í•˜ëŠ” ë¬¸ì œê°€ ìˆë‹¤.

> ğŸ” ë‹¹ì—°í•˜ê²Œë„ CleitenBean2ë¼ëŠ” ë¹ˆì´ PrototypeBeanì„ ì£¼ì…ë°›ëŠ”ë‹¤ë©´ ClientBeanê³¼ ClientBean2ì˜ PrototypeBeanì€ ë‹¤ë¥¸ ê°ì²´ë‹¤.

ìš°ë¦¬ê°€ ì›í•˜ë˜ ê²ƒì€ ì‹±ê¸€í†¤ë¹ˆê³¼ í”„ë¡œí† íƒ€ì…ë¹ˆì„ ê°™ì´ ì“¸ë•Œ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì…ë¹ˆì„ ìƒì„±í•˜ë©´ì„œ countê°€ ê³„ì† 1ì´ ë‚˜ì˜¤ê¸°ë¥¼ ì›í•œê²ƒì¸ë° 3ì´ ë‚˜ì™”ë‹¤. 
`í•´ë‹¹ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ë©´ ì–´ë–»ê²Œí•´ì•¼ ë ê¹Œ?`

## ì‹±ê¸€í†¤ë¹ˆê³¼ í”„ë¡œí† íƒ€ì…ë¹ˆ ê°™ì´ì‚¬ìš©ì‹œ ë¬¸ì œì  í•´ê²°ë°©ë²•
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ì£¼ì…ë°›ì•„ì„œ ì¡°íšŒí•˜ì—¬ í•´ê²°
- Providerë¡œ í•´ê²°

<br>

### ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ì£¼ì…ë°›ì•„ì„œ ì¡°íšŒí•˜ì—¬ í•´ê²°
<br>

__ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì…ë¹ˆ ìƒì„± í™•ì¸ í…ŒìŠ¤íŠ¸ ì½”ë“œ__
```java
@Test
void singletonClientusePrototype2(){
    AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(ClientBean.class , PrototypeBean.class);
    int count = 0; //count init;


    ClientBean clientBean1 = ac.getBean(ClientBean.class);
    count = clientBean1.logic();
    System.out.println("clientBean1.logic() // count => "+ count);

    ClientBean clientBean2 = ac.getBean(ClientBean.class);
    count = clientBean2.logic();
    System.out.println("clientBean2.logic() // count => "+ count);

    ClientBean clientBean3 = ac.getBean(ClientBean.class);
    count = clientBean3.logic();
    System.out.println("clientBean3.logic() // count => "+ count);

    Assertions.assertThat(count).isEqualTo(1);
    ac.close();
}
```

logic()í˜¸ì¶œì‹œ ë§ˆë‹¤ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì…ë¹ˆ ìƒì„±
```java
@Scope("singleton") //defualtê°€ ì‹±ê¸€í†¤ ìƒëµê°€ëŠ¥
static class ClientBean{
    @Autowired
    private ApplicationContext ac;

    public int logic() {
        //ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ í”„ë¡œí† íƒ€ì…ë¹ˆ ì¡°íšŒ
        PrototypeBean prototypeBean = ac.getBean(PrototypeBean.class);
        prototypeBean.addCount();
        int count = prototypeBean.getCount();
        return count;
    }

    @PostConstruct
    public void init(){
        System.out.println("ClientBean.init "+ this);
    }

    @PreDestroy
    public void destroy(){
        System.out.println("ClientBean.destroy "+ this);
    }
}
```

__í…ŒìŠ¤íŠ¸ ê²°ê³¼__

![image](https://user-images.githubusercontent.com/97019540/231439128-6b3b91c7-245d-43cb-bf25-0865a44f01bd.png)

> AnnotationConfigurationContext íŒŒë¼ë¯¸í„°ì— ClientBean.classì™€ PrototypeBean.classê°€ ì¸ìë¡œ ë“¤ì–´ê°€ê³  í•´ë‹¹ í´ë˜ìŠ¤ ì •ë³´ë¡œ ë¹ˆë©”íƒ€ì •ë³´ê°€ ìƒì„±ë˜ëŠ”ë° ClientBeanì´ ìƒì„±ë  ë•Œ ApplicationContextë¥¼ í•„ë“œì£¼ì…ì„ ë°›ê³ 
ê·¸ ë‹¤ìŒ logic()ë©”ì„œë“œë¥¼ í˜¸ì¶œ í• ë•Œ gebean()ë©”ì„œë“œë¡œ prototypeBeanì´ ìƒì„±ë˜ëŠ” ê²ƒì„ ë³¼ìˆ˜ ìˆë‹¤. 


- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ì£¼ì…ë°›ì•„ì„œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ë§¤ë²ˆ ìƒˆë¡œ getBeaní•˜ë©´ ìƒˆë¡œìš´ í”„ë¡œí†  íƒ€ì… ë¹ˆì´ ìƒì„±ë¨

- ì§ì ‘ í•„ìš”í•œ ì˜ì¡´ê´€ê³„ë¥¼ ì°¾ëŠ” ê²ƒì„ Dependency Lookup(DL), ì˜ì¡´ê´€ê³„ íƒìƒ‰ì´ë¼ê³  í•¨

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ì£¼ì…ë°›ê²Œ ë˜ë©´, ì»¨í…Œì´ë„ˆì— ì˜ì¡´í•˜ê²Œ ë˜ê³  ë‹¨ìœ„í…ŒìŠ¤íŠ¸ë„ ì–´ë ¤ì›Œì§€ëŠ” ë¬¸ì œê°€ ìˆìŒ


### ObjectProvider

```java
@Scope("singleton") //defualtê°€ ì‹±ê¸€í†¤ ìƒëµê°€ëŠ¥
static class ClientBean{
    @Autowired
    //ObjectProviderë¥¼ ì‚¬ìš©í•˜ë©´ í•´ë‹¹ ObjectProvider<T> ì œë„¤ë ‰íƒ€ì…ì— ë“¤ì–´ì˜¨ íƒ€ì…ì„ getObject()ì„ í†µí•´
    //ìŠ¤í”„ë§ì»¨í…Œì´ë„ˆì—ì„œ ì°¾ì•„ì„œ ë°˜í™˜í•œë‹¤.
    private ObjectProvider<PrototypeBean> objectProvider;

    public int logic() {
        PrototypeBean prototypeBean = objectProvider.getObject();
        prototypeBean.addCount();
        return prototypeBean.getCount();
    }
    ...
}
```

- ObJectProvider<ì°¾ì„ ë¹ˆ íƒ€ì…> objectProvicer ê°ì²´ë¥¼ ìƒì„± í›„
   getObject()ë¥¼ í˜¸ì¶œí•˜ë©´ ìŠ¤í”„ë§ì»¨í…Œì´ë„ˆì—ì„œ í•´ë‹¹ë¹ˆì„ ì°¾ì•„ì„œ ë°˜í™˜í•´ì¤€ë‹¤. (Dependency Lookup == DL)
- ê¸°ëŠ¥ì´ ë‹¨ìˆœí•˜ë¯€ë¡œ ë‹¨ìœ„í…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“¤ê±°ë‚˜ mock ì½”ë“œë¥¼ ë§Œë“¤ê¸°ëŠ”
ë¹„êµì  í¸ë¦¬í•¨ (í•˜ì§€ë§Œ ì•„ì§ê¹Œì§€ ìŠ¤í”„ë§ì— ì˜ì¡´ì )
- ìƒì†, ì˜µì…˜, ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ë“± í¸ì˜ ê¸°ëŠ¥ì´ ë§ìŒ

### @Lookup

```java
static class ClientBean{
    @Lookup
    public PrototypeBean getPrototypeBean(){
        // ì—¬ê¸°ì„œ ìŠ¤í”„ë§ì€ ëŸ°íƒ€ì„ì‹œì— ë™ì ìœ¼ë¡œ ì¬ì •ì˜í•¨
        return null;
    }

    public int logic() {
        PrototypeBean prototypeBean = getPrototypeBean();

        prototypeBean.addCount();
        return prototypeBean.getCount();
    }
}
```
- @Lookupì´ ë¶™ì€ ë©”ì†Œë“œë¥¼ ëŸ°íƒ€ì„ ì‹œ ì˜¤ë²„ë¼ì´ë“œ(ì¬ì •ì˜) í•œë‹¤.
- @Lookup ì–´ë…¸í…Œì´ì…˜ì„ ëª…ì‹œ í›„ public ì°¾ì„ íƒ€ì… getì°¾ì„íƒ€ì…(){}
- @Lookup ì‹œ ë©”ì„œë“œëŠ” private static finalì´ ì˜¬ìˆ˜ ì—†ìŒ
- bean classëŠ” finalì¼ ìˆ˜ ì—†ë‹¤.
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì‹œ ë²ˆê±°ëŸ¬ì›€ì´ ìˆìŒ
- ìŠ¤í”„ë§ì— ì˜ì¡´ì ì´ì§€ ì•ŠìŒ

### JSR-330 Provider

âœ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ í•´ì•¼í•¨!

(ìŠ¤í”„ë§ ë¶€íŠ¸ 3.0 > í˜„ì¬ë²„ì „) ? `javax.inject:javax.inject:1 : akarta.inject:jakarta.inject-api:2.0.1`

gradle ì— ì¶”ê°€í•˜ê¸°!

```java
static class ClientBean{
    @Autowired
    //Javaí‘œì¤€ JSR-330 Provider ì‚¬ìš©
    private Provider<PrototypeBean> provider;

    public int logic() {
        //ìŠ¤í”„ë§ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì£¼ì…ë°›ì•„ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì¡°íšŒí•˜ì—¬ ì‚¬ìš©í•¨ (í”„ë¡œí† íƒ€ì… ë¹ˆì€ ì¡°íšŒì‹œ ìƒˆë¡œ ìƒì„±ë¨).
        //PrototypeBean prototypeBean = ac.getBean(PrototypeBean.class);
        PrototypeBean prototypeBean = provider.get();
        prototypeBean.addCount();
        return prototypeBean.getCount();
    }
}
```

- get()ë©”ì„œë“œ í•˜ë‚˜ë¡œ ê¸°ëŠ¥ì´ ë§¤ìš° ë‹¨ìˆœ
- ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš”
- ìë°”í‘œì¤€ì´ë¯€ë¡œ ìŠ¤í”„ë§ì™¸ì— ë‹¤ë¥¸ DIì»¨í…Œì´ë„ˆì—ì„œë„ ì‚¬ìš©ê°€ëŠ¥
- ë‹¨ìœ„í…ŒìŠ¤íŠ¸, mockì½”ë“œ ìƒì„±ì´ ì‰¬ì›€

## ì°¸ê³ !!
> ğŸ“Œ DLì€ ê¼­ í”„ë¡œí† íƒ€ì… ë¹ˆì´ ì•„ë‹ˆë¼ë„ í•„ìš”í•œê³³ì— ì‚¬ìš©í•œë‹¤!

### ì‹¤ë¬´ì—ì„œ DLì„ ìœ„í•œ ProviderëŠ” ë­˜ ì“¸ì§€?
 
 > ì£¼ë¡œ ì•„ë˜ ë‘ê°€ì§€ ë°©ë²•ì˜ DLì„ ì´ìš©í•œë‹¤.

- ObjectProvider
    > í¸ì˜ ê¸°ëŠ¥ì„ ë§ì´ ì œê³µí•´ì£¼ê³  ìŠ¤í”„ë§ ì™¸ ë³„ë„ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í•„ìš”ì—†ìœ¼ë¯€ë¡œ ëŒ€ë¶€ë¶„ ì´ê±¸ ì‚¬ìš©
- JSR-330 Provider
    > ë‹¤ë¥¸ DI ì»¨í…Œì´ë„ˆ ì‚¬ìš©ì‹œ ì‚¬ìš©í•¨


## ì›¹ ìŠ¤ì½”í”„

__ì›¹ ìŠ¤ì½”í”„ì˜ íŠ¹ì§•__

- ì›¹ í™˜ê²½ì—ì„œë§Œ ë™ì‘
- ìŠ¤í”„ë§ì´ í•´ë‹¹ ìŠ¤ì½”í”„ë¥¼ ì‹œì‘ë¶€í„° ì¢…ë£Œì‹œì ê¹Œì§€ ê´€ë¦¬í•œë‹¤.

__ì›¹ ìŠ¤ì½”í”„ ì¢…ë¥˜__
- request: HTTP ìš”ì²­ í•˜ë‚˜ê°€ ë“¤ì–´ì˜¤ê³  ë‚˜ê°ˆ ë•Œ ê¹Œì§€ ìœ ì§€ë˜ëŠ” ìŠ¤ì½”í”„, `ê°ê°ì˜ HTTP ìš”ì²­`ë§ˆë‹¤ `ë³„ë„ì˜ ë¹ˆ ì¸ìŠ¤í„´ìŠ¤`ê°€ ìƒì„±ë˜ê³ , ê´€ë¦¬
- session: HTTP Sessionê³¼ ë™ì¼í•œ ìƒëª…ì£¼ê¸°ë¥¼ ê°€ì§€ëŠ” ìŠ¤ì½”í”„
- application: ì„œë¸”ë¦¿ ì»¨í…ìŠ¤íŠ¸( ServletContext )ì™€ ë™ì¼í•œ ìƒëª…ì£¼ê¸°ë¥¼ ê°€ì§€ëŠ” ìŠ¤ì½”í”„
- websocket: ì›¹ ì†Œì¼“ê³¼ ë™ì¼í•œ ìƒëª…ì£¼ê¸°ë¥¼ ê°€ì§€ëŠ” ìŠ¤ì½”í”„


__HTTP request ìš”ì²­ ë‹¹ ê°ê° í• ë‹¹ë˜ëŠ” request scope__

![image](https://user-images.githubusercontent.com/97019540/231738912-07f3209c-a890-459a-8dc8-e76796249379.png)

ìš°ë¦¬ê°€ MyLoggerë¼ëŠ” ë¡œê·¸ì°ëŠ” í´ë˜ìŠ¤ë¥¼ request scopeë¡œ ë“±ë¡ í›„ í´ë¼ì´ì–¸íŠ¸ Aê°€ ìš”ì²­ì„ ë³´ëƒˆë‹¤ê³  ê°€ì •í•˜ì.

ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ myLoggerë¥¼ ìš”ì²­ë°›ì•˜ë‹¤ë©´ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” A ì „ìš©ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë¹ˆì„ ìƒì„±í•´ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ì— ì£¼ì…í•´ì¤€ë‹¤. (request scopeì´ê¸° ë•Œë¬¸ì— ìš”ì²­ ì‹œ ìƒì„±ë˜ê³  ë°˜ë‚©ê¹Œì§€ ê´€ë¦¬í•¨)

ê·¸ë¦¬ê³  ë¡œì§ì´ ì§„í–‰ë˜ë©´ì„œ ì„œë¹„ìŠ¤ì—ì„œ ë‹¤ì‹œ myLoggerê°€ í•„ìš”í•´ì„œ ìš”ì²­ì„ í•˜ê²Œ ë˜ë©´ ë°©ê¸ˆ Aì „ìš©ìœ¼ë¡œ ìƒì„±í–ˆë˜ ë¹ˆì„ ê·¸ëŒ€ë¡œ í™œìš©í•´ì„œ ì£¼ì…ë°›ëŠ”ë‹¤.

ë‹¤ë¥¸ í´ë¼ì´ì–¸íŠ¸Bê°€ í´ë¼ì´ì–¸íŠ¸Aì™€ ë™ì‹œì— ìš”ì²­ì„ ë³´ëƒˆì—ˆë‹¤ê³  ê°€ì •.

í´ë¼ì´ì–¸íŠ¸Bë„ ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ì„œë¹„ìŠ¤ì—ì„œ myLoggerê°€ ê°ê° í•„ìš”.
ì´ ë•ŒëŠ” í´ë¼ì´ì–¸íŠ¸Aì—ê²Œ ì£¼ì…í•´ì£¼ì—ˆë˜ ë¹ˆì´ ì•„ë‹Œ ìƒˆë¡œ ìƒì„±í•´ì„œ ì£¼ê²Œë¨

`request scopeë¥¼ í™œìš©í•˜ë©´ ë””ë²„ê¹…í•˜ê¸° ì‰¬ìš´ ë¡œê·¸í™˜ê²½ì„ ë§Œë“¤ ìˆ˜ ìˆìŒ`


<br>

## __request ìŠ¤ì½”í”„ë¥¼ í™œìš©í•œ ë¡œê·¸ì°ëŠ” ì˜ˆì œ__

 __MyLogger.class__ (ë¡œê·¸ë¥¼ ì¶œë ¥í•˜ê¸° ìœ„í•œ í´ë˜ìŠ¤)

```java
@Component
@Scope("request")
public class MyLogger {
    private String uuid;
    private String requestURL;

    public void setRequestURL(String requestURL) {
        this.requestURL = requestURL;
    }

    public void log(String message){
        System.out.println("[" + uuid + "]" + "[" + requestURL + "] "+ message);
    }

    @PostConstruct
    public void init(){
        uuid = UUID.randomUUID().toString();
        System.out.println("[" + uuid + "]" + "request bean scope create : "+ this);
    }

    @PreDestroy
    public void close(){
        System.out.println("[" + uuid + "]" + "request bean scope close : "+ this);
    }
}
```

- ê¸°ëŒ€í•˜ëŠ” ê³µí†µ í¬ë©§: [UUID][requestURL] {message}
- ë‹¤ë¥¸ HTTP ìš”ì²­ê³¼ êµ¬ë¶„í•˜ê¸° ìœ„í•œ uuidë¥¼ ì´ˆê¸°í™”ì‹œ ìƒì„±í•˜ì—¬ ì €ì¥
- requestURL ì •ë³´ë„ ì¶”ê°€ (ì–´ë–¤ URLì„ ìš”ì²­í•´ì„œ ë‚¨ì€ ë¡œê·¸ì¸ì§€ í™•ì¸)

__LogDemoController.class__ (ë¡œê±°ê°€ ì˜ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” í…ŒìŠ¤íŠ¸ìš© ì»¨íŠ¸ë¡¤ëŸ¬)
```java
@Controller
@RequiredArgsConstructor
public class LogDemoController {
    private final LogDemoService logDemoService;
    private final MyLogger myLogger;

    @RequestMapping("log-demo")
    @ResponseBody
    public String logDemo(HttpServletRequest request){


        String requestURL = request.getRequestURL().toString();
        myLogger.setRequestURL(requestURL);

        myLogger.log("controller test");
        logDemoService.logic("testId");

        return "Test OK";
    }
}
```
- HttpServletRequestë¥¼ í†µí•´ì„œ ìš”ì²­ URLì„ ë°›ìŒ (http://localhost:8080/log-demo)
- requestURL ê°’ì„ myLoggerì— ì €ì¥ (myLoggerëŠ” HTTP ìš”ì²­ ë‹¹ ê°ê° UUIDë¡œ êµ¬ë¶„)


__LogDemoService__ (ì„œë¹„ìŠ¤ ê³„ì¸µì—ì„œë„ ë¡œê·¸ë¥¼ ì¶œë ¥)
```java
@Service
@RequiredArgsConstructor
public class LogDemoService {

    private final MyLogger myLogger;

    public void logic(String id){
        myLogger.log("service id => "+ id);
    }
}
```

__request scope ì¥ì __

- request scopeë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  íŒŒë¼ë¯¸í„°ë¡œ ì´ ëª¨ë“  ì •ë³´ë¥¼ ì„œë¹„ìŠ¤ ê³„ì¸µì— ë„˜ê¸´ë‹¤ë©´, íŒŒë¼ë¯¸í„°ê°€ ë§ì•„ì„œ ì§€ì €ë¶„í•´ì§„ë‹¤. 
- ë” ë¬¸ì œëŠ” requestURL ê°™ì€ ì›¹ê³¼ ê´€ë ¨ëœ ì •ë³´ê°€ ì›¹ê³¼
ê´€ë ¨ì—†ëŠ” ì„œë¹„ìŠ¤ ê³„ì¸µê¹Œì§€ ë„˜ì–´ê°€ê²Œ ëœë‹¤. 
- `ì›¹ê³¼ ê´€ë ¨ëœ ë¶€ë¶„ì€ ì»¨íŠ¸ë¡¤ëŸ¬ê¹Œì§€ë§Œ ì‚¬ìš©`í•˜ê³ , `ì„œë¹„ìŠ¤ ê³„ì¸µì€ ì›¹ ê¸°ìˆ ì— ì¢…ì†ë˜ì§€ ì•Šê³ , ê°€ê¸‰ì  ìˆœìˆ˜í•˜ê²Œ ìœ ì§€`í•˜ëŠ” ê²ƒì´ ìœ ì§€ë³´ìˆ˜ ê´€ì ì—ì„œ ì¢‹ë‹¤.
- request scopeì˜ MyLogger ë•ë¶„ì— ì´ëŸ° ë¶€ë¶„ì„ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê¸°ì§€ ì•Šê³ , MyLoggerì˜ ë©¤ë²„ë³€ìˆ˜ì— ì €ì¥í•´ì„œ ì½”ë“œì™€ ê³„ì¸µì„ ê¹”ë”í•˜ê²Œ ìœ ì§€í•  ìˆ˜ ìˆë‹¤.

__ê¸°ëŒ€í•˜ëŠ” ê²°ê³¼__
```java
[97cbdf77...]request bean scope create : com.hello.core.common.MyLogger@3617c1ca
[97cbdf77...][http://localhost:8096/log-demo] controller test
[97cbdf77...][http://localhost:8096/log-demo] service id => testId
[97cbdf77...]request bean scope close : com.hello.core.common.MyLogger@3617c1ca
```

> í¬íŠ¸ë²ˆí˜¸ëŠ” 8080(defaultì„)ì„ ì´ë¯¸ ì“°ê³ ìˆì–´ì„œ ë³€ê²½í•¨ <br>
`application.properties`ì—ì„œ "server.port = ì›í•˜ëŠ”í¬íŠ¸ë²ˆí˜¸ë¡œ " ë³€ê²½ê°€ëŠ¥]

__ì‹¤ì œ ê²°ê³¼__
```
Error creating bean with name 'myLogger': Scope 'request' is not active for the
current thread; consider defining a scoped proxy for this bean if you intend to
refer to it from a singleton;
```

ì´ëŸ° ì˜¤ë¥˜ê°€ ë°œìƒí•˜ëŠ” ì´ìœ ëŠ” `request scope`ëŠ” httpìš”ì²­ì´ ìˆì„ ë•Œ ìƒì„±ì´ ë˜ê¸°ë•Œë¬¸ì— ìŠ¤í”„ë§ì»¨í…Œì´ë„ˆê°€ ì˜¬ë¼ê°€ëŠ” ì‹œì ì—ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ MyLoggerë¥¼ ì£¼ì…ë°›ì•„ì•¼ë˜ëŠ”ë° scopeë²”ìœ„ê°€ requestì´ê¸° ë•Œë¬¸ì— ë¹ˆì´ ìƒì„±ì´ ë˜ì§€ ì•Šì•„ì„œ ë°œìƒí•˜ì˜€ë‹¤.

## ì§€ì—°ì²˜ë¦¬ë¥¼ ì´ìš©í•œ í•´ê²°ë°©ë²• 2ê°€ì§€

### Provider (ObjectProvider , JSR-330 Provider)

> ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ì„œë¹„ìŠ¤ë¥¼ ì•„ë˜ì™€ ê°™ì´ ë³€ê²½í•´ë³´ì.

> ObjectProvider , ìë°”í‘œì¤€ì¸ Provider ë‘˜ì¤‘ ì•„ë¬´ê±°ë‚˜ ì¨ë„ ìƒê´€ì—†ì´ ë™ì‘í•œë‹¤. (ë³¸ì¸ì€ `javax.inject.Provider` ì‚¬ìš©.)

__Test Controller__
```java
@Controller
@RequiredArgsConstructor
public class LogDemoController {
    private final LogDemoService logDemoService;
    //private final MyLogger myLogger;
    private final Provider<MyLogger> providerMyLogger;

    @RequestMapping("log-demo")
    @ResponseBody
    public String logDemo(HttpServletRequest request){


        String requestURL = request.getRequestURL().toString();
        //myLogger.setRequestURL(requestURL);
        providerMyLogger.get().setRequestURL(requestURL);

        //myLogger.log("controller test");
        providerMyLogger.get().log("controller test");
        logDemoService.logic("testId");

        return "Test OK";
    }
}
```
__LogDemService__
```java
@Service
@RequiredArgsConstructor
public class LogDemoService {

    //private final MyLogger myLogger;
    private final Provider<MyLogger> providerMyLogger;

    public void logic(String id){
        //myLogger.log("service id => "+ id);
        providerMyLogger.get().log("service id => "+ id);
    }
}
```
__í…ŒìŠ¤íŠ¸ ê²°ê³¼__ 
```java
[1129bc8f...]request bean scope create : com.hello.core.common.MyLogger@3707a576
[1129bc8f...][http://localhost:8096/log-demo] controller test
[1129bc8f...][http://localhost:8096/log-demo] service id => testId
[1129bc8f...]request bean scope close : com.hello.core.common.MyLogger@3707a576
```

- ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ì„œë¹„ìŠ¤ê³„ì¸µ ì½”ë“œë¥¼ ë³´ë©´ MyLoggerë¥¼ ë°”ë¡œ ì£¼ì…ë°›ëŠ”ê²Œ ì•„ë‹ˆë¼ Providerë¥¼ ì£¼ì…ë°›ëŠ”ë‹¤.
- Provider ë•ë¶„ì— providerMyLogger.get()ì„ í˜¸ì¶œ ì „ê¹Œì§€ myLogger(request scope) ìƒì„±ì„ ì§€ì—°í•¨
- ê·¸ë¦¬ê³  providerMyLogger.get()ì„ ì„œë¹„ìŠ¤ì™€ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ê°ê° ì‹¤í–‰í•´ë„ ê°™ì€ UUIDì¸ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ëŠ” httpìš”ì²­ì´ ê°™ìœ¼ë©´ ê°™ì€ ìŠ¤í”„ë§ ë¹ˆì´ ë°˜í™˜ëœë‹¤ëŠ”ê±¸ ì•Œìˆ˜ ìˆë‹¤.

### í”„ë¡ì‹œ(Proxy)ë¥¼ ì´ìš©í•œ ë°©ë²•


MyLoger.classë¥¼ ì•„ë˜ì™€ê°™ì´ ë³€ê²½

__ë³€ê²½ëœ MyLoger.class__
```java
@Component
@Scope(value = "request", proxyMode = ScopedProxyMode.TARGET_CLASS)
public class MyLogger {
    private String uuid;
    private String requestURL;
    ...
}
```

> Controllerì™€ SerivceëŠ” Providerë¥¼ ì ìš©í•˜ê¸° ì „ìœ¼ë¡œ ë˜ëŒë¦¬ì.
<details>
<summary>
ë˜ëŒë¦° ì½”ë“œ
</summary>

__Test Controller__

```java
@Controller
@RequiredArgsConstructor
public class LogDemoController {
    private final LogDemoService logDemoService;
    private final MyLogger myLogger;
    //private final Provider<MyLogger> providerMyLogger;

    @RequestMapping("log-demo")
    @ResponseBody
    public String logDemo(HttpServletRequest request){


        String requestURL = request.getRequestURL().toString();
        myLogger.setRequestURL(requestURL);
        //providerMyLogger.get().setRequestURL(requestURL);

        myLogger.log("controller test");
        //providerMyLogger.get().log("controller test");
        logDemoService.logic("testId");

        return "Test OK";
    }
}
```

__Serivce__

```java
@Service
@RequiredArgsConstructor
public class LogDemoService {

    private final MyLogger myLogger;
    //private final Provider<MyLogger> providerMyLogger;

    public void logic(String id){
        myLogger.log("service id => "+ id);
        //providerMyLogger.get().log("service id => "+ id);
    }
}
```
</details>

<br>

__ê²°ê³¼__

```
[6332aba2-47f0-4297-ae5c-a85076e731ec]request bean scope create : com.hello.core.common.MyLogger@791275b6
[6332aba2-47f0-4297-ae5c-a85076e731ec][http://localhost:8096/log-demo] controller test
[6332aba2-47f0-4297-ae5c-a85076e731ec][http://localhost:8096/log-demo] service id => testId
[6332aba2-47f0-4297-ae5c-a85076e731ec]request bean scope close : com.hello.core.common.MyLogger@791275b6
```

Providerì™€ ë˜‘ê°™ì´ ì •ì‚­ì ìœ¼ë¡œ ì˜ëœë‹¤.
ê·¸ ì´ìœ ëŠ” ë°‘ì— `ì›¹ ìŠ¤ì½”í”„ì™€ í”„ë¡ì‹œ ë™ì‘ ì›ë¦¬`ì—ì„œ ì´ì–´ ì„¤ëª…í•˜ê² ë‹¤.

## í”„ë¡ì‹œ ë™ì‘ ì›ë¦¬

ì»¨íŠ¸ë¡¤ëŸ¬ë‚˜ ì„œë¹„ìŠ¤ì—ì„œ ì£¼ì…ëœ MyLoggerë¥¼ ë°‘ì— ì½”ë“œë¡œ í™•ì¸í•´ë³´ì

```java
System.out.println("myLogger = " + myLogger.getClass());
```
__ì¶œë ¥ ê°’__
```
myLogger = class com.hello.core.common.MyLogger$$EnhancerBySpringCGLIB$$19f6ce0f
```

`EnhancerBySpringCGLIB$$19f6ce0f`ê°€ ë¶™ì€ê±¸ ë³¼ ìˆ˜ìˆë‹¤.


### CGLIBë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ë‚´ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ì€ ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ë¥¼ ë§Œë“¤ì–´ì„œ ì£¼ì…í•œë‹¤.

- @Scope ì˜ proxyMode = ScopedProxyMode.TARGET_CLASS) ë¥¼ ì„¤ì •í•˜ë©´ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” CGLIB
ë¼ëŠ” ë°”ì´íŠ¸ì½”ë“œë¥¼ ì¡°ì‘í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•´ì„œ, MyLoggerë¥¼ ìƒì†ë°›ì€ ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ë¥¼
ìƒì„±
- ìˆœìˆ˜í•œ MyLogger í´ë˜ìŠ¤ê°€ ì•„ë‹ˆë¼ `MyLogger$$EnhancerBySpringCGLIB` ì´ë¼ëŠ” í´ë˜ìŠ¤ë¡œ ë§Œë“¤ì–´ì§„ ê°ì²´ê°€ ëŒ€ì‹  ë“±ë¡

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— "myLogger"ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì§„ì§œ ëŒ€ì‹ ì— ì´ ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ë¥¼ ë“±ë¡

- ac.getBean("myLogger", MyLogger.class) ë¡œ ì¡°íšŒí•´ë„ í”„ë¡ì‹œ ê°ì²´ê°€ ì¡°íšŒë¨

- ì˜ì¡´ê´€ê³„ ì£¼ì…ë„ ì´ ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ê°€ ì£¼ì…ëœë‹¤.


![image](https://user-images.githubusercontent.com/97019540/231749391-9004c71a-482a-4444-8619-cbcbedc71adc.png)


__ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ëŠ” ìš”ì²­ì´ ì˜¤ë©´ ê·¸ë•Œ ë‚´ë¶€ì—ì„œ ì§„ì§œ ë¹ˆì„ ìš”ì²­í•˜ëŠ” ìœ„ì„ ë¡œì§ì´ ë“¤ì–´ìˆë‹¤.__

- ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ëŠ” ë‚´ë¶€ì— ì§„ì§œ myLoggerë¥¼ ì°¾ëŠ” ë°©ë²•ì„ ì•Œê³  ìˆë‹¤.
- í´ë¼ì´ì–¸íŠ¸ê°€ myLogger.logic() ì„ í˜¸ì¶œí•˜ë©´ ì‚¬ì‹¤ì€ ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ì˜ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•œ ê²ƒì´ë‹¤.
- ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ëŠ” request ìŠ¤ì½”í”„ì˜ ì§„ì§œ myLogger.logic() ë¥¼ í˜¸ì¶œí•œë‹¤.
- ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ëŠ” ì›ë³¸ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ì•„ì„œ ë§Œë“¤ì–´ì¡Œê¸° ë•Œë¬¸ì— ì´ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ ì…ì¥ì—ì„œëŠ” ì‚¬ì‹¤ ì›ë³¸ì¸ì§€ ì•„ë‹Œì§€ë„ ëª¨ë¥´ê²Œ, ë™ì¼í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤(ë‹¤í˜•ì„±)

__ë™ì‘ ì •ë¦¬__

- CGLIBë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ë‚´ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ì€ ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ë¥¼ ë§Œë“¤ì–´ì„œ ì£¼ì…í•œë‹¤.
- ì´ ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ ìš”ì²­ì´ ì˜¤ë©´ ê·¸ë•Œ ë‚´ë¶€ì—ì„œ ì‹¤ì œ ë¹ˆì„ ìš”ì²­í•˜ëŠ” ìœ„ì„ ë¡œì§ì´ ë“¤ì–´ìˆë‹¤.
- ê°€ì§œ í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ `request scope`ì™€ëŠ” ê´€ê³„ê°€ ì—†ë‹¤. ê·¸ëƒ¥ ê°€ì§œì´ê³ , ë‚´ë¶€ì— ë‹¨ìˆœí•œ ìœ„ì„ ë¡œì§ë§Œ ìˆê³ , `ì‹±ê¸€í†¤ ì²˜ëŸ¼ ë™ì‘`í•œë‹¤.

__íŠ¹ì§• ì •ë¦¬__

- ì• ë…¸í…Œì´ì…˜ ì„¤ì • ë³€ê²½ë§Œìœ¼ë¡œ ì›ë³¸ ê°ì²´ë¥¼ í”„ë¡ì‹œ ê°ì²´ë¡œ ëŒ€ì²´í•¨ `(ë‹¤í˜•ì„±ê³¼ DI
ì»¨í…Œì´ë„ˆê°€ ê°€ì§„ í° ê°•ì )`

- í”„ë¡ì‹œ ê°ì²´ ë•ë¶„ì— í´ë¼ì´ì–¸íŠ¸ëŠ” ë§ˆì¹˜ ì‹±ê¸€í†¤ ë¹ˆì„ ì‚¬ìš©í•˜ë“¯ì´ í¸ë¦¬í•˜ê²Œ request scopeë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

__ì£¼ì˜ì __

- ì‹±ê¸€í†¤ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒ ê°™ì§€ë§Œ ë‹¤ë¥´ê²Œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì— ê²°êµ­ ì£¼ì˜í•´ì„œ ì‚¬ìš©

- ì´ëŸ° íŠ¹ë³„í•œ scopeëŠ” ê¼­ í•„ìš”í•œ ê³³ì—ë§Œ ìµœì†Œí™”í•´ì„œ ì‚¬ìš©

- ë¬´ë¶„ë³„í•˜ê²Œ ì‚¬ìš©í•˜ë©´ ìœ ì§€ë³´ìˆ˜í•˜ê¸° ì–´ë ¤ì›€


<br>

__ğŸˆ Providerë¥¼ ì‚¬ìš©í•˜ë“ , í”„ë¡ì‹œë¥¼ ì‚¬ìš©í•˜ë“  í•µì‹¬ ì•„ì´ë””ì–´ëŠ” ì§„ì§œ ê°ì²´ ì¡°íšŒë¥¼ `ê¼­ í•„ìš”í•œ ì‹œì ê¹Œì§€ ì§€ì—°ì²˜ë¦¬` í•œë‹¤ëŠ” ì ì´ë‹¤.__

__ğŸˆ ì›¹ ìŠ¤ì½”í”„ê°€ ì•„ë‹ˆì–´ë„ í”„ë¡ì‹œëŠ” ì—¬ëŸ¬ê³³ì—ì„œ ì‚¬ìš©ëœë‹¤.__